"""Basic API tests for SecureTranscribe."""

import pytest
from fastapi.testclient import TestClient
import sys
import os

sys.path.insert(0, os.path.join(os.path.dirname(__file__), "..", "app"))

try:
    from main import app
except ImportError as e:
    print(f"Failed to import app: {e}")
    pytest.exit("Cannot import main app")

def test_health_check():
    with TestClient(app) as client:
        response = client.get("/health")
        assert response.status_code == 200
        data = response.json()
        assert "status" in data

def test_info_endpoint():
    with TestClient(app) as client:
        response = client.get("/info")
        assert response.status_code == 200
        data = response.json()
        assert "name" in data
        assert "version" in data

def test_main_page():
    with TestClient(app) as client:
        response = client.get("/")
        assert response.status_code == 200
        assert "html" in response.headers["content-type"]
